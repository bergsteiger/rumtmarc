: K351668202

: "Проверка, закрылся ли баллон 'Информация об изменениях' "
 "Открываем НК"
 "В документе не должно быть комментариев"
 6 раза ( "Перейти на параграф вниз" )
 "Переместиться в начало строки"
 "Выделить слово справа"
 "Контрол в фокусе" "Выделенный текст редактора" "Заменить непечатаемые символы" РАВНО 'Часть ' ! IF
 'Вероятно, не закрылся баллон Информация об изменениях!' .
 ENDIF
; // "Проверка, закрылся ли баллон 'Информация об изменениях' "

: "Установить курсор мыши на ссылку 'информация об изменениях' в НК"
 VAR Editor
  VAR x
  VAR y
  "Открываем НК"
  "Контрол в фокусе" >>> Editor
  Editor pop:editor:ParaMiddleCoordsToScreen >>> y >>> x
  y 80 + >>> y
  x y "Установить курсор мыши по координатам"
  "Узнать индекс курсора мыши" "Узнать имя индекс курсора мыши" РАВНО 'crHandPoint' ! IF
   'Не попали на ссылку Информация об изменениях! Тест прератил работу!' .
    HALT
  ENDIF
; // "Установить курсор мыши на ссылку 'информация об изменениях' в НК"

 : Действия
  "Установить курсор мыши на ссылку 'информация об изменениях' в НК"
  "Клик левой кнопкой мыши" 
  "В начало документа"
  "Выделить {(3)} параграфов"
  TRY
   "Сравнить выделенный текст текущего редактора с эталоном в формате {(CF_RTF)}"
  FINALLY
   "Установить курсор мыши на ссылку 'информация об изменениях' в НК"
   "Клик левой кнопкой мыши"
  END
 ; // Действия
 
 "Запомнить позицию мыши и выполнить {(@ Действия)}"
 "Проверка, закрылся ли баллон 'Информация об изменениях' "
;

K351668202