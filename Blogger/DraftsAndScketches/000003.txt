<div dir="ltr" style="text-align: left;" trbidi="on">
Моё знакомство с "промышленным тестированием" было описано тут -&nbsp;<a href="http://18delphi.blogspot.ru/2013/03/blog-post.html">http://18delphi.blogspot.ru/2013/03/blog-post.html</a><br />
<br />
И с тех пор я ничего лучшего не написал.<br />
<br />
Но это было далеко не TDD.<br />
<br />
И не "тестирование в широком смысле этого слова".<br />
<!--more--><br />
Итак.<br />
<br />
Что я хочу сказать о TDD и о "тестировании вообще"?<br />
<br />
Я сам долго и нудно "бился головой об стену" пытаясь обеспечить "стабильность разработки".<br />
<br />
Нет... Не организации, а "своей собственной".<br />
<br />
Чтобы "спать спокойно".<br />
<br />
Чтобы не было того, что "что-то вчера поправил, а через три месяца оно вылезло".<br />
<br />
Или наоборот - "сегодня поправил одно - завтра вылезло другое, послезавтра поправил другое, а на третий день вылезло первое".<br />
<br />
Я много думал и размышлял над "всякими разными возможностями тестирования".<br />
<br />
Подход "на коленке" кстати описан тут -&nbsp;<a href="http://18delphi.blogspot.ru/2013/11/5.html">http://18delphi.blogspot.ru/2013/11/5.html</a><br />
<br />
Именно "на коленке".<br />
<br />
Это было <b>задолго</b> до всяких там DUnit и TDD <b>тем более</b>.<br />
<br />
Знаете как я тестировал свой функционал?<br />
<br />
У меня была "развесистая" структура директорий - примерно такая -&nbsp;<a href="https://sourceforge.net/p/rumtmarc/code-0/HEAD/tree/trunk/Blogger/DraftsAndScketches/testset/">https://sourceforge.net/p/rumtmarc/code-0/HEAD/tree/trunk/Blogger/DraftsAndScketches/testset/</a><br />
<br />
Там даже на даты интересно посмотреть:<br />
<br />
<pre>%producer 'ЭВЕРЕСТ (lite) 1.0.0.154' date '06.11.2002'
%producer 'ЭВЕРЕСТ 1.0.0.163' date '31.03.2003'
%producer 'ЭВЕРЕСТ 1.0.0.714' date '02.11.2004'
%producer 'ЭВЕРЕСТ 1.0.0.92' date '28.03.2001'
%producer 'ЭВЕРЕСТ (lite) 1.0.0.115' date '15.01.2002'
%producer 'ЭВЕРЕСТ 1.0.0.99' date '22.05.2001'
</pre>
<br />
etc.<br />
<br />
Десять лет назад.. Примерно... А то и больше...

<br />
<br />
И были всякие "батники", а также "тулзы" и тулзочки", позволяющие <b>как-то</b> протестировать тот факт, что "ничего не сломалось" при очередной правке исходников.<br />
<br />
А ещё были всякие "ToDo-списки" или "записочки приклееннные к монитору".<br />
<br />
Ну что поделаешь. Есть люди, которые говорят, что "тестирование нам не нужно, мы и так уверены в своём коде и своей работе". Ну что же. ЕСТЬ!<br />
<br />
Я много таких видел и вижу. Но я <b>не из их числа</b>. Ну не повезло мне в жизни. Не обладаю я "аналитическим умом".<br />
<br />
Я умею решать задачи в стиле "спринта". Вдох-сделал дело-Выдох.<br />
<br />
Ну как-то так -&nbsp;<a href="http://18delphi.blogspot.ru/2013/11/5.html?showComment=1384893262611#c9008430456835077997">http://18delphi.blogspot.ru/2013/11/5.html?showComment=1384893262611#c9008430456835077997</a><br />
<br />
Да и жизнь диктует "спринт" и XP (<a href="http://ru.wikipedia.org/wiki/%D0%AD%D0%BA%D1%81%D1%82%D1%80%D0%B5%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">http://ru.wikipedia.org/wiki/%D0%AD%D0%BA%D1%81%D1%82%D1%80%D0%B5%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5</a>)<br />
<br />
Хотя - водопад - "самая удобная модель для программиста" -&nbsp;<a href="http://18delphi.blogspot.ru/2013/08/blog-post.html">http://18delphi.blogspot.ru/2013/08/blog-post.html</a><br />
<br />
Процитирую - "ТЗ — это большое БЛАГО для программиста. „Водопад“ — возможность творчески работать, не загоняя себя в угол."<br />
<br />
ЕЩЁ РАЗ - "ТЗ — это большое БЛАГО для программиста. „Водопад“ — возможность творчески работать, не загоняя себя в угол."<br />
<br />
И ЕЩЁ РАЗ - "ТЗ — это большое БЛАГО для программиста. „Водопад“ — возможность творчески работать, не загоняя себя в угол."<br />
<br />
Но! Мы живём в "обычном мире". В мире "спринта", XP и Agile.<br />
<br />
Что такое XP и Agile на мой взгляд? Скажу - "это там где кончается порядок", там "где нет договорённостей".<br />
<br />
Как ТОЛЬКО "заказчик" начинает "уходить от ответа" - начинается XP и Agile -&nbsp;<a href="http://18delphi.blogspot.ru/2013/04/blog-post.html">http://18delphi.blogspot.ru/2013/04/blog-post.html</a><br />
<br />
Так "причём тут TDD"?<br />
<br />
Ещё раз повторюсь - на TDD и DUnit я смотрел "долго и вдумчиво". (Хотя это совсем не одно и то же).<br />
<br />
И скажем такую вещь как "атомарные тесты" (<a href="http://18delphi.blogspot.ru/2013/04/blog-post_2326.html">http://18delphi.blogspot.ru/2013/04/blog-post_2326.html</a>) в DUnit - "я пропустил мимо ушей". Хотя потом и написал свои - (<a href="http://18delphi.blogspot.ru/2013/07/2_18.html">http://18delphi.blogspot.ru/2013/07/2_18.html</a>&nbsp;- например&nbsp;AtomicListTest.imp.pas).<br />
<br />
Я думал - <b>"ЧТО ЗА ЧУШЬ" </b>- тестировать "тот факт, что элемент добавился в список", да ещё и <b>на правильное место</b>.<br />
<br />
Я думал - "да быть того не может, чтобы <b>было иначе</b>".<br />
<br />
И я <b>очень хорошо</b> помню ТЕ ощущения. Полного идиотизма.<br />
<br />
Но видимо это - "высшая степень дзена", когда начинаешь понимать, что <b>атомарные</b> и <b>примитивные</b> тесты - это ОЧЕНЬ ВАЖНО.<br />
<br />
Опять - же - НИКОГО НИКУДА не тяну.<br />
<br />
Ещё раз - НИКОГО НИКУДА не тяну.<br />
<br />
Просто пытаюсь передать свои <b>ощущения</b>.<br />
<br />
Кстати "лирическое отступление" -"Сегодня мне показалось, что я нашёл ошибку в менеджере памяти Delphi XE" (<a href="http://18delphi.blogspot.ru/2013/04/delphi-xe.html">http://18delphi.blogspot.ru/2013/04/delphi-xe.html</a>).<br />
<br />
Глядя в ОТЛАДЧИК - я БЫЛ УВЕРЕН, что ошибка у Embarcadero.<br />
<br />
Пока я не стал выделять "атомарный тест", чтобы отослать в Embarcadero и "поймать их за хвост". А когда я НАПИСАЛ ТЕСТ и он ПРОШЁЛ и раз, и два, и десять, и тысячу раз - я усомнился - и начал искать "проблемы на своей стороне". И таки - <b>нашёл</b>.<br />
<br />
Буду банален - "практика - критерий истины".<br />
<br />
И всё же - "ближе к теме".<br />
<br />
Что я хочу сказать?<br />
<br />
Тут есть одна проблема - с одной стороны - DUnit - я уже писал - первое моё впечатление о нём было - "ну не космос, я тоже так умею". А с другой стороны - TDD.<br />
<br />
Откроем википедию и почитаем:<br />
<br />
<a href="http://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0_%D1%87%D0%B5%D1%80%D0%B5%D0%B7_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">http://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0_%D1%87%D0%B5%D1%80%D0%B5%D0%B7_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5</a><br />
<br />
"<br />
<h3 style="background-color: white; background-image: none; border-bottom-style: none; font-family: sans-serif; font-size: 17px; line-height: 19.1875px; margin: 0px 0px 0.3em; overflow: hidden; padding-bottom: 0.17em; padding-top: 0.5em;">
<span class="mw-headline" id=".D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.82.D0.B5.D1.81.D1.82.D0.B0">Добавление теста</span><span class="mw-editsection mw-editsection-expanded" style="-webkit-user-select: none; direction: ltr; display: inline-block; font-size: x-small; font-weight: normal; line-height: 1em; margin-left: 1em; padding-right: 0.25em; unicode-bidi: -webkit-isolate; vertical-align: baseline; white-space: nowrap;"><span class="mw-editsection-bracket" style="color: #555555; margin-left: -0.25em; margin-right: 0.25em;">[</span><a class="mw-editsection-visualeditor" href="http://ru.wikipedia.org/w/index.php?title=%D0%A0%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0_%D1%87%D0%B5%D1%80%D0%B5%D0%B7_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;veaction=edit&amp;section=3" style="background-image: none; background-position: initial initial; background-repeat: initial initial; color: #0b0080; text-decoration: none;" title="Редактировать раздел «Добавление теста»">править</a><span class="mw-editsection-divider" style="color: #555555;">&nbsp;|&nbsp;</span><a href="http://ru.wikipedia.org/w/index.php?title=%D0%A0%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0_%D1%87%D0%B5%D1%80%D0%B5%D0%B7_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5&amp;action=edit&amp;section=3" style="background-image: none; background-position: initial initial; background-repeat: initial initial; color: #0b0080; text-decoration: none;" title="Редактировать раздел «Добавление теста»">править исходный текст</a><span class="mw-editsection-bracket" style="color: #555555; margin-left: 0.25em; margin-right: -0.25em;">]</span></span></h3>
<div style="background-color: white; font-family: sans-serif; font-size: 13px; line-height: 19.1875px; margin-bottom: 0.5em; margin-top: 0.4em;">
При разработке через тестирование, добавление <b>каждой новой функциональности</b> (<a href="http://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA" style="background-image: none; background-position: initial initial; background-repeat: initial initial; color: #0b0080; text-decoration: none;" title="Английский язык">англ.</a>&nbsp;<i><span lang="en" xml:lang="en">feature</span></i>) в программу начинается с написания теста. Неизбежно этот тест не будет проходить, поскольку соответствующий код ещё не написан. (Если же написанный тест прошёл, это означает, что либо предложенная «новая» функциональность уже существует, либо тест имеет недостатки.) Чтобы написать тест, разработчик должен чётко понимать предъявляемые к новой возможности требования. Для этого рассматриваются возможные сценарии использования и пользовательские истории. Новые требования могут также повлечь изменение существующих тестов. Это отличает разработку через тестирование от техник, когда тесты пишутся после того, как код уже написан: она заставляет разработчика сфокусироваться на требованиях до написания кода&nbsp;— тонкое, но важное отличие."</div>
<div style="background-color: white; font-family: sans-serif; font-size: 13px; line-height: 19.1875px; margin-bottom: 0.5em; margin-top: 0.4em;">
<br /></div>
<div style="background-color: white; font-family: sans-serif; font-size: 13px; line-height: 19.1875px; margin-bottom: 0.5em; margin-top: 0.4em;">
<br /></div>
<b>Каждой </b>новой функциональности. Выделено мной.<br />
<br />
Ещё раз.&nbsp;<b>Каждой&nbsp;</b>новой функциональности.<br />
<br />
Когда читаешь это - мозги начинают разбегаться как тараканы.<br />
<br />
Какой функциональности? Что считать функциональностью? Правда каждой новой?<br />
<br />
И - ВСЁ - <b>АЛЕС КАПУТ</b>. Идея - <b>ПОХОРОНЕНА</b> заживо её же создателями.<br />
<br />
Я сам НЕ РАЗ пытался "подступиться к TDD" и отступал.<br />
<br />
Почему?<br />
<br />
Скажу то, что я сам думал и слышал от бесчётного числа людей - "как же так - КАЖДУЮ новую функциональность протестировать. А работать когда?"<br />
<br />
Резонный вопрос? Не правда ли?<br />
<br />
Я сам себе его не ОДНУ ТЫСЯЧУ раз задавал.<br />
<br />
Пока не понял одной банальной вещи -&nbsp;"Дорога в тысячу ли начинается с одного шага".<br />
<br />
Ещё раз -&nbsp;"Дорога в тысячу ли начинается с одного шага".<br />
<br />
НЕТУ "чисто объектных языков" и нету "чисто функциональных языков".<br />
<br />
Ну может <b>где-то</b> есть но не в практике применения (<a href="http://18delphi.blogspot.ru/2013/11/blog-post_3004.html">http://18delphi.blogspot.ru/2013/11/blog-post_3004.html</a>).<br />
<br />
И тому подтверждение вот это -&nbsp;<a href="http://18delphi.blogspot.ru/2013/11/blog-post_2.html?showComment=1384183753080#c1086781562262325290">http://18delphi.blogspot.ru/2013/11/blog-post_2.html?showComment=1384183753080#c1086781562262325290</a><br />
<br />
Пока я не написал ПЕРВЫЕ ДВА ТЕСТА.<br />
<br />
А дальше жить стало "легче и веселее".<br />
<br />
Что такое TDD <b>на мой</b> взгляд? Где тут Driven?<br />
<br />
Driven это не в том, чтобы "писать тест под каждую функциональность".<br />
<br />
Driven - оно СОВСЕМ в <b>другом</b>.<br />
<br />
По-моему ВСЕ программисты вставили перед вопросом - "я это сделал - я как это протестировать".<br />
<br />
И только ЛУЧШИЕ говорили - "мой код - безупречен - тестировать нечего".<br />
<br />
А "менее лучшие" начинали искать "всякие разные возможности". Типа "а где в настоящей системе это протестировать"? Или "а давайте сделаем тестовое приложение".<br />
<br />
А блин? Где? Как и почему?<br />
<br />
Куда это тестовое приложение положить? И как оно должно работать? И вообще - "лень делать очередное тестовое приложение".<br />
<br />
Ну и всё сводится к тому, что "протыкали пару мест и ладно". Простите, но вот это -&nbsp;<a href="http://18delphi.blogspot.ru/2013/05/resolved.html">http://18delphi.blogspot.ru/2013/05/resolved.html</a>&nbsp;-&nbsp;тому пример.<br />
<br />
А "с другой стороны" - TDD - "тестируйте ВСЮ функциональность".<br />
<br />
Как из этой "вилки" выбраться?<br />
<br />
Я для себя эту проблему решил - "просто". Вот смотрите - если мне надо что-то реализовать, или переделать, то я уточняю ТЗ - насколько это возможно, а дальше начинаю кодировать.<br />
<br />
Но как?<br />
<br />
Где я проверяю функциональность? В <b>реальной</b> системе? Далеко - не всегда! (Хотя и такое тоже случается). Я "обычно" пишу тест - ИМЕННО на ту функциональность, которую я реализую например при помощи DUnit или совсем "на коленке" -&nbsp;<a href="http://18delphi.blogspot.ru/2013/11/5.html">http://18delphi.blogspot.ru/2013/11/5.html</a>.<br />
<br />
Хотя эти "коленки" - многого стоят. Поверьте мне.<br />
<br />
Вот тут я писал про логирование -&nbsp;<a href="http://18delphi.blogspot.ru/2013/11/gui-back-to-basics_22.html">http://18delphi.blogspot.ru/2013/11/gui-back-to-basics_22.html</a>&nbsp;(банально) и "о чудо!" при помощи этих логов я нашёл аж две ошибки.<br />
<br />
Просто глядя на логи. А не "долго и вдумчиво" курил "отладчик и брейкпоинты".<br />
<br />
НЕ СТОИТ пытаться написать "супер-тест", который "всё покажет". Нету такого в природе.<br />
<br />
Только цикл - тест - функционал - тест. Или функционал - тест - функционал.<br />
<br />
В чём же Driven?<br />
<br />
А в ТОМ, что тесты это не просто ИНСТРУМЕНТ для тестирования, и даже скажем так - это СОВСЕМ не инструменты для тестирования.<br />
<br />
Это в ПЕРВУЮ очередь инструменты для разработки системы и "исследования её поведения".<br />
<br />
ТЕСТЫ - это ОТЛИЧНОЕ поле для отладки. А ЛИШЬ потом - поле для "поверки регресса".<br />
<br />
Ну в самом деле - "если тест написан - не выкидывать же его".<br />
<br />
По крайней мере - пока он работает.<br />
<br />
Ещё раз.<br />
<br />
Тесты - ОБЕСПЕЧИВАЮТ в <b>первую очередь</b> - инфраструктуру для отладки. А уж потом - "меряют регресс".<br />
<br />
Я наверное так долго - <b>именно</b> эту мысль и пытался донести.<br />
<br />
И ещё раз. ТЕСТЫ - <b>инфраструктура</b> для отладки. В ПЕРВУЮ очередь.<br />
<br />
А уж потом - "регресс" и всё остальное.<br />
<br />
И ещё - я много видел и вижу людей, которые пытаются "создать супер-тест" и в итоге - <b>ничего </b>не делают. А лишь только размышляют в духе - "ах как хорошо бы было бы посторить мост".<br />
<br />
Никого никуда не тяну.<br />
<br />
"Лучше ОДИН кривой и косой тест, чем тысяча ИДЕАЛЬНЫХ, но <b>ненаписанных</b>".<br />
<br />
А "идеологи TDD" - сами себе по-моему карму портят словами "каждая функциональность", "любой метод" и т.д и т.п.<br />
<br />
Не надо "тестов ради тестов"...<br />
<br />
Написали тест. Он не прошёл - потом подгоняем функциональность...<br />
<br />
Ну бред... Затраты времени.. Бред...<br />
<br />
Где-то может и не бред, но "где-то"...<br />
<br />
"Не сотвори себе кумира". Как-то так.<br />
<br />
Не "бейтесь головой об стену". Не пытайтесь "найти серебряную пулю". Напишите ПЕРВЫЙ тест. А потом ВТОРОЙ. А потом и ТРЕТИЙ.<br />
<br />
Я УВЕРЕН - вам понравится.</div>
